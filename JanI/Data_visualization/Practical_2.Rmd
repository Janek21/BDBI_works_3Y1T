---
title: "**Data visualization in R**<br><font color='#A8A8A8' size='5'>Reproducing `ggplot2` graphs</font><img src='https://www.construction21.org/espana/data/sources/users/8/images/logoesci-fons-blanc.png' style='position:absolute;top:0px;left:0px;' width='10%'/>"
author: "Jan Izquierdo Ramos"
date: "29 September 2023"
output:
  prettydoc::html_pretty:
    theme: leonids 
    highlight: github
        
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width = 6, fig.height = 4, fig.align='center')
# install.packages("prettydoc")
```

<style>
  @import url(https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,500,500i,700,700i);
  @import url(https://cdn.rawgit.com/tonsky/FiraCode/1.204/distr/fira_code.css);
  @import url("https://use.fontawesome.com/releases/v5.10.1/css/all.css");
  
  body {
    font-family: 'Fira Sans','Droid Serif', 'Palatino Linotype', 'Book Antiqua', Palatino, 'Microsoft YaHei', 'Songti SC', serif;
  }
  
  /* Make bold syntax compile to RU-red */
  strong {
    color: #cc0033;
  }
  
  .nav3 {
    height: auto;
    float: left;
    padding-left: 20px;
    padding-top: 20px;
    padding-right: 20px;
}
</style>



## Introduction

We are going to reproduce three different plots, of which we are only given the data set and the final image file. Each of them has two versions:

- The first version is a plot made just using the layer functions of `ggplot2` and leaving everything else with the defaults. This is, using `ggplot`, `geom_*`, `stat_*` and `annotate_*` functions (click on the image to see it bigger). 

<a href="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p1_simple2020_10_4D11_52_42.png" target="new">
    <img src="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p1_simple2020_10_4D11_52_42.png" alt="random image" width="30%">
</a><a href="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p2_simple2022_10_2D10_14_44.png" target="new">
    <img src="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p2_simple2022_10_2D10_14_44.png" alt="random image" width="30%">
</a> <a href="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p3_simple2020_10_4D11_54_15.png" target="new">
    <img src="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p3_simple2020_10_4D11_54_15.png" alt="random image" width="30%">
</a>

- The second version builds from the first plot to create a more complex display with customized `scales_*`, `coord_*`, `facet_*` or `theme_*`. Helper functions such as `labs()` or `guides()` could also be used (click on the image to see it bigger). 

<a href="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p1_complete2022_10_2D10_14_29.png" target="new">
    <img src="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p1_complete2022_10_2D10_14_29.png" alt="random image" width="30%">
</a> <a href="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p2_complete2022_10_2D10_14_17.png" target="new">
    <img src="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p2_complete2022_10_2D10_14_17.png" alt="random image" width="30%">
</a> <a href="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p3_complete2022_10_2D10_13_8.png" target="new">
    <img src="http://bioinformatica.uab.cat/base/documents/sgbcursos/documents/p3_complete2022_10_2D10_13_8.png" alt="random image" width="30%">
</a>


```{r}
library(ggplot2)
```

&emsp;<i class="fas fa-info-circle"></i>: `ggplot2` will automatically load all three data sets used in this practical.

### Organization of the practical

You will see different icons through the document, the meaning of which is:

&emsp;<i class="fas fa-info-circle"></i>: additional or useful information<br>
&emsp;<i class="fas fa-search"></i>: a worked example<br>
&emsp;<i class="fa fa-cogs"></i>: a practical exercise<br>
&emsp;<i class="fas fa-comment-dots"></i>: a space to answer the exercise<br>
&emsp;<i class="fa fa-key"></i>: a hint to solve an exercise<br>
&emsp;<i class="fa fa-rocket"></i>: a more challenging exercise<br><br>

----------------------------------------------------------------------------------

## **<i class="fa fa-cogs"></i> Simple versions**

### **Plot 1**

<div style="background-color:#F0F0F0">
##### &emsp;<i class="fas fa-comment-dots"></i> Answer:
```{r answer1.1}
# Dataset used: diamonds
ggplot(data=diamonds, aes(x=clarity, y=log10(carat)))+
  geom_point(aes(color=cut), position=position_jitter(width=0.4))+
  geom_violin(fill="black")
```
&emsp;
</div>

### **Plot 2**

&emsp;<i class="fa fa-key"></i> Need help with the count numbers shown in each stacked bar? https://stackoverflow.com/questions/6644997/showing-data-values-on-stacked-bar-chart-in-ggplot2

<div style="background-color:#F0F0F0">
##### &emsp;<i class="fas fa-comment-dots"></i> Answer:
```{r answer1.2}
# Dataset used: mpg
ggplot(data=mpg, mapping = aes(x=manufacturer, fill = class))+
  geom_bar()+
  geom_text(stat='count', aes(label=..count..), position = position_stack(vjust = 0.5))
```
&emsp;
</div>

### **Plot 3**

<div style="background-color:#F0F0F0">
##### &emsp;<i class="fas fa-comment-dots"></i> Answer:
```{r answer1.3}
# Dataset: ToothGrowth
ggplot(data=ToothGrowth, aes(x=as.factor(dose), y=len))+
  geom_boxplot(aes(color=supp, fill=supp), color="black")+
  geom_hline(yintercept = mean(ToothGrowth$len), lty="dashed")
```
&emsp;
</div>

----------------------------------------------------------------------------------

## **<i class="fa fa-rocket"></i> Complex versions**

### **Plot 1**

<div style="background-color:#F0F0F0">
##### &emsp;<i class="fas fa-comment-dots"></i> Answer:
```{r answer2.1}
ggplot(data=diamonds, aes(x=clarity, y=log10(carat)))+
  geom_point(aes(color=cut), position=position_jitter(width=0.4))+
  geom_violin(fill="black")+
  facet_wrap(cut ~ ., ncol=5)+ggtitle("Diamond quality")+
  theme_bw()+theme(legend.position="none")
```
&emsp;
</div>

### **Plot 2**

<div style="background-color:#F0F0F0">
##### &emsp;<i class="fas fa-comment-dots"></i> Answer:
```{r answer2.2}
ggplot(data=mpg, aes(x=manufacturer, fill = class))+
  geom_bar()+
  geom_text(stat='count', aes(label=..count..), position = position_stack(vjust = 0.5))+
  coord_flip()+scale_fill_brewer(type="qual", palette = 2)+
  labs(x="Manufacturer", y="Number of cars", fill = "Car type")
```
&emsp;
</div>


&emsp;<i class="fa fa-key"></i> This graph uses a `scale_fill_brewer` palette, can you find which one?

### **Plot 3**


<div style="background-color:#F0F0F0">
##### &emsp;<i class="fas fa-comment-dots"></i> Answer:
```{r answer2.3, warning=F}
ggplot(data=ToothGrowth, aes(x=as.factor(dose), y=len))+
  geom_boxplot(aes(colour = supp, fill = supp), color="black")+
  geom_hline(data= ToothGrowth, yintercept= mean(ToothGrowth$len), lty = "dashed")+
  scale_fill_brewer(type="seq", palette=7, direction=-1, label= c("Orange juice", "Vitamin C"))+
  labs(y="Tooth length", x="Dose (mg/day)", fill="Supplement")+
  theme_classic()
```
&emsp;
</div>

&emsp;<i class="fa fa-key"></i> This graph uses a `scale_fill_brewer` palette, can you find which one?
